pico-8 cartridge // http://www.pico-8.com
version 41
__lua__
-- bouncy ball demo
-- by zep

size  = 10
ball = {
  x=64,
  y=size,
}
floor_y = 100

-- starting velocity
velx = rnd(6)-3
vely = rnd(6)-3

mouse = {
  clicked = false,
  x = 0,
  y = 0,
}

function _draw()
	cls(1)
	
	//print("press ❎ to bump",
	//      32,10, 6)
	
	fillp(░)
	rectfill(0,floor_y,127,127,12)
	fillp() -- reset
	
	circfill(ball.x,ball.y,size,14)
	
	spr(1,ball.x-4-velx, 
	      ball.y-4-vely)
	      
	circfill(mouse.x, mouse.y, 2, 0)
	draw_launcher()
	draw_score()
end

function _update60()
	poke(0x5f2d, 1)
	mouse.x = stat(32)
	mouse.y = stat(33)
	mouse.clicked = (stat(34) & 1) > 0
	-- move ball left/right
 update_launcher()
 update_score()
	
	if ball.x+velx < 0+size or
	   ball.x+velx > 128-size
	then
		-- bounce on side!
		velx *= -1 
		sfx(1)
	else
		-- move by x velocity
		ball.x += velx
	end
	
	-- move ball up/down
	
	if ball.y+vely < 0+size or
	   ball.y+vely > floor_y-size
	then
		-- bounce on floor/ceiling
		vely = vely * -0.3
		sfx(0)
		
		-- if bounce was too small,
		-- bump into air
		-- if vely < 0 and
		--   vely > -0.5 then
		--	velx = rnd(6)-3
		--	vely = -rnd(5)-4
		--	sfx(3)
		--end
		
	else
		ball.y += vely
	end
	
	-- gravity!
	vely += 0.2
	
	-- press ❎ to ranomly
	-- choose a new velocity
	
	if (btnp(0)) then
		velx = -2
		vely = -4
		sfx(2)
	end
	
 if (btnp(1)) then
		velx = 2
		vely = -4
		sfx(2)
	end

	
end


score = {
  hits  = 0,
  ninja_score = 0,
  mouse_score = 0,
  t     = 0,
}

function draw_score()
  print("ninja score:", 0, 0, 6)
  print(flr(score.ninja_score), 6)

  print("mouse score:", 80, 0, 6)
  print(flr(score.mouse_score), 80, 6)
  print(score.hits, 80, 12, 9)
end

function update_score()
  score.t += 1
  score.ninja_score = 
    score.t/10 - score.hits*20

  score.mouse_score = 
    score.hits*100 - score.t/20
end
-->8
-- rocket

function make_rocket(target)
  local r = {
	  x=0,
	  y=0,
	  angle=0,
	  target={
	    x=target.x,
	    y=target.y,
	  },
	  speed=0.03,
		}
		return r
end

function draw_rocket(rocket)
  spr(4, rocket.x, rocket.y)
end


function update_rocket(rocket)
  if false then
    rocket.target.x = mouse.x
    rocket.target.y = mouse.y
  end
  
  rocket.x += (rocket.target.x - rocket.x)*rocket.speed
  rocket.y += (rocket.target.y - rocket.y)*rocket.speed

  if rocket.target.x - rocket.x  < 10 then
    add_explosion(rocket)
    del(launcher.rockets, rocket)
  end
end


-- launcher 

launcher = {
  rockets = {},
  explosions = {},
  charge=0,
	 max_charge=30,
}

function add_explosion(pos)
	add(
		launcher.explosions, 
		make_explosion(pos))
end


function draw_launcher()
  foreach(launcher.rockets, draw_rocket)
  foreach(launcher.explosions, draw_explosion)
end

function update_launcher()
  launcher.charge += 1
  if mouse.clicked 
  	and launcher.charge>=launcher.max_charge then
    add(
      launcher.rockets, 
      make_rocket(mouse))
    launcher.charge = 0
  end
  foreach(launcher.rockets, update_rocket)
  foreach(launcher.explosions, update_explosion)
end

-- explosions

function make_explosion(pos)
  return {
    x= pos.x,
    y= pos.y,
    radius= 5,
    max_radius=15,
  }
end

function update_explosion(explosion)
  if explosion.radius >= explosion.max_radius then
  	del(launcher.explosions, explosion)
  end
  explosion.radius += 0.5
  
  if abs(explosion.x - ball.x) <= explosion.radius and
     abs(explosion.y - ball.y) <= explosion.radius then
   del(launcher.explosions, explosion)
   score.hits += 1
   sfx(4)  
  end
end


function draw_explosion(e)
 fillp(✽)
	circfill(e.x,e.y,e.radius, 8)
	fillp() -- reset
	
	fillp(▥)
	circfill(e.x,e.y,e.radius/2, 5)
	fillp() -- reset
end
__gfx__
0000000000888700009cc90077770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000008888880009cc90077770000888000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0070070008ffff80999cc999007700000bbbbb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000085ff580cccccccc77777777033333b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0007700008ffff80cccccccc77777777888333300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0070070088888888999cc99970707077033333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000008888880009cc90070707077888000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000800800009cc90070707077000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__label__
88888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888
88888777777888eeeeee888888888888888888888888888888888888888888888888888888888888888ff8ff8888228822888222822888888822888888228888
8888778887788ee88eee88888888888888888888888888888888888888888888888888888888888888ff888ff888222222888222822888882282888888222888
888777878778eeee8eee88888e88888888888888888888888888888888888888888888888888888888ff888ff888282282888222888888228882888888288888
888777878778eeee8eee8888eee8888888888888888888888888888888888888888888888888888888ff888ff888222222888888222888228882888822288888
888777878778eeee8eee88888e88888888888888888888888888888888888888888888888888888888ff888ff888822228888228222888882282888222288888
888777888778eee888ee888888888888888888888888888888888888888888888888888888888888888ff8ff8888828828888228222888888822888222888888
888777777778eeeeeeee888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
1eee1ee11ee111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
1e111e1e1e1e11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
1ee11e1e1e1e11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
1e111e1e1e1e11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
1eee1e1e1eee11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11661166116616661666111111111111117711111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
16111611161616161611111117771111117111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
16661611161616611661111111111111177111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11161611161616161611111117771111117111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
16611166166116161666111111111111117711111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111161616661666116611111111111111111ccc111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111161611611161161111111111177711111c1c111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111166611611161166611111111111111111c1c111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111161611611161111611111111177711111c1c117111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111161616661161166111111111111111111ccc171111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111116611661166166616661111111111111ccc111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111161116111616161616111111177711111c1c111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111166616111616166116611111111111111c1c111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111616111616161616111111177711111c1c117111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111166111661661161616661111111111111ccc171111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111166611111111111111111111111111111ccc111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111116111111111111111111111177711111c1c111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111116111111111111111111111111111111c1c111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111116111111111111111111111177711111c1c117111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111116111111111111111111111111111111ccc171111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
17711111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11711111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11771111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11711111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
17711111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
1eee1e1e1ee111ee1eee1eee11ee1ee1111116611666166616161111116611661166166616661171117111111111111111111111111111111111111111111111
1e111e1e1e1e1e1111e111e11e1e1e1e111116161616161616161111161116111616161616111711111711111111111111111111111111111111111111111111
1ee11e1e1e1e1e1111e111e11e1e1e1e111116161661166616161111166616111616166116611711111711111111111111111111111111111111111111111111
1e111e1e1e1e1e1111e111e11e1e1e1e111116161616161616661111111616111616161616111711111711111111111111111111111111111111111111111111
1e1111ee1e1e11ee11e11eee1ee11e1e111116661616161616661666166111661661161616661171117111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
111111111bbb1bbb1bbb1bb11bbb11711c1c1ccc11cc1c1c11cc1ccc111111cc11cc11cc1ccc1ccc11111c1c111111111ccc111111111ccc111111111c111171
111111111b1b1b1b11b11b1b11b117111c1c1ccc1c1c1c1c1c111c1111111c111c111c1c1c1c1c1111c11c1c111111111c1c111111111c1c111111111c111117
111111111bbb1bb111b11b1b11b1171111111c1c1c1c1c1c1ccc1cc111111ccc1c111c1c1cc11cc111111111111111111c1c111111111c1c111111111ccc1117
111111111b111b1b11b11b1b11b1171111111c1c1c1c1c1c111c1c111111111c1c111c1c1c1c1c1111c11111117111111c1c117111111c1c117111111c1c1117
111111111b111b1b1bbb1b1b11b1117111111c1c1cc111cc1cc11ccc11111cc111cc1cc11c1c1ccc11111111171111111ccc171111111ccc171111111ccc1171
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
111111111bbb1bbb1bbb1bb11bbb117111661166116616661666111111661166116616661666111111111c111171111111111111111111111111111111111111
111111111b1b1b1b11b11b1b11b1171116111611161616161611111116111611161616161611111111111c111117111111111111111111111111111111111111
111111111bbb1bb111b11b1b11b1171116661611161616611661111116661611161616611661111111111ccc1117111111111111111111111111111111111111
111111111b111b1b11b11b1b11b1171111161611161616161611111111161611161616161611117111111c1c1117111111111111111111111111111111111111
111111111b111b1b1bbb1b1b11b1117116611166166116161666117116611166166116161666171111111ccc1171111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
111111111bbb1bbb1bbb1bb11bbb11711166116611661666166611111616166616661166111111111cc11ccc1171111111111111111111111111111111111111
111111111b1b1b1b11b11b1b11b1171116111611161616161611111116161161116116111111111111c1111c1117111111111111111111111111111111111111
111111111bbb1bb111b11b1b11b1171116661611161616611661111116661161116116661111111111c11ccc1117111111111111111111111111111111111111
111111111b111b1b11b11b1b11b1171111161611161616161611111116161161116111161171111111c11c111117111111111111111111111111111111111111
111111111b111b1b1bbb1b1b11b111711661116616611616166611711616166611611661171111111ccc1ccc1171111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
111111111bbb1bbb1bbb1bb11bbb11711c1c1cc11ccc1cc11ccc1ccc111111cc11cc11cc1ccc1ccc11111c1c111111111ccc111111111ccc111111111c111171
111111111b1b1b1b11b11b1b11b117111c1c1c1c11c11c1c11c11c1c11111c111c111c1c1c1c1c1111c11c1c111111111c1c111111111c1c111111111c111117
111111111bbb1bb111b11b1b11b1171111111c1c11c11c1c11c11ccc11111ccc1c111c1c1cc11cc111111111111111111c1c111111111c1c111111111ccc1117
111111111b111b1b11b11b1b11b1171111111c1c11c11c1c11c11c1c1111111c1c111c1c1c1c1c1111c11111117111111c1c117111111c1c117111111c1c1117
111111111b111b1b1bbb1b1b11b1117111111c1c1ccc1c1c1cc11c1c11111cc111cc1cc11c1c1ccc11111111171111111ccc171111111ccc171111111ccc1171
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
111111111bbb1bbb1bbb1bb11bbb117111661166116616661666111111661166116616661666111111111c111171111111111111111111111111111111111111
111111111b1b1b1b11b11b1b11b1171116111611161616161611111116111611161616161611111111111c111117111111111111111111111111111111111111
111111111bbb1bb111b11b1b11b1171116661611161616611661111116661611161616611661111111111ccc1117111111111111111111111111111111111111
111111111b111b1b11b11b1b11b1171111161611161616161611111111161611161616161611117111111c1c1117111111111111111111111111111111111111
111111111b111b1b1bbb1b1b11b1117116611166166116161666117116611166166116161666171111111ccc1171111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
111111111bbb1bbb1bbb1bb11bbb11711166116611661666166611111616166616661166111111111cc11ccc1171111111111111111111111111111111111111
111111111b1b1b1b11b11b1b11b1171116111611161616161611111116161161116116111111111111c1111c1117111111111111111111111111111111111111
111111111bbb1bb111b11b1b11b1171116661611161616611661111116661161116116661111111111c11ccc1117111111111111111111111111111111111111
111111111b111b1b11b11b1b11b1171111161611161616161611111116161161116111161171111111c11c111117111111111111111111111111111111111111
111111111b111b1b1bbb1b1b11b111711661116616611616166611711616166611611661171111111ccc1ccc1171111111111111111111111111111111111111
88888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888
82888222822882228888822882288288888282288222822288888888888888888888888888888888888888888222822282288882822282288222822288866688
82888828828282888888882888288288882888288882828888888888888888888888888888888888888888888288828288288828828288288282888288888888
82888828828282288888882888288222882888288222822288888888888888888888888888888888888888888222822288288828822288288222822288822288
82888828828282888888882888288282882888288288888288888888888888888888888888888888888888888882828288288828828288288882828888888888
82228222828282228888822282228222828882228222822288888888888888888888888888888888888888888222822282228288822282228882822288822288
88888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888

__sfx__
000300000f01112051180311e021280113a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000100001a76011750247300070000700007000070000700007000070000700007000070000700007000070000700007000070000700007000070000700007000070000700007000070000700007000070000700
000400000c47011470164600f460164501b44013430164201b420184201d4202241027410164000c4000c4000f40013400114000c4000f4000f4000c400004000040000400004000040000400004000040000400
000400000c5700c5501154018530165201f5101d50018500185001f500225001d5001f500225002b5002250029500245002450029500275002b5002b500005000050000500005000050000500005000050000500
000400000d1200f1201522017220192201c2201e120202202222024220212201f2201e2201d2201c2201b220192201622016220142201222012220112201022010220102200f2200e2200d2200d2200e2200d220
00010000187501675013750117500f7500d75011750107500e7500d75000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
